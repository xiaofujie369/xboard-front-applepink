<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">

  <title>å¯äº‘</title>

  <!-- å¼ºåˆ¶éªŒè¯ï¼šæœªé€šè¿‡åˆ™è·³è½¬ verify.html -->
  <script>
    if (!sessionStorage.getItem("cf_verified")) {
      if (!window.location.pathname.includes("verify.html")) {
        window.location.href = "/verify.html";
      }
    }
  </script>

  <!-- ç™»å½•æˆåŠŸåå…¬å‘Šå¼¹çª—ï¼ˆæ¯æ¬¡ç™»å½•å¼¹ä¸¤æ¬¡ï¼‰ -->
  <script>
    (function () {

      // ç™»å½•æ—¶æ¸…ç©ºè®°å½•
      sessionStorage.removeItem("first_popup_done");
      sessionStorage.removeItem("second_popup_done");

      // å¼¹çª— HTML å‡½æ•°
      function popupHTML() {
        return `
        <div class="notice-mask" id="noticePopup"
             style="position:fixed;left:0;top:0;width:100%;height:100%;
             background:rgba(0,0,0,0.45);backdrop-filter:blur(3px);z-index:99999;
             display:flex;align-items:center;justify-content:center;">
          <div class="notice-box"
               style="width:500px;max-width:92%;background:white;
               padding:24px;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,0.2);
               position:relative;font-size:15px;">

            <div id="noticeClose"
                 style="position:absolute;right:16px;top:12px;font-size:22px;
                 cursor:pointer;">Ã—</div>

            <h2 style="margin:0 0 10px;font-weight:700;">ğŸ“¢ æ–°äººå¿…çœ‹å…¬å‘Š</h2>

            <p>æ¬¢è¿æ¥åˆ°å¯äº‘ï¼Œè¯·åŠ¡å¿…é˜…è¯»é¡¶éƒ¨å…¬å‘Šæ ä¿¡æ¯ã€‚</p>
            <p>è¯·ä¿å­˜æˆ‘ä»¬æœ€æ–°åŸŸåï¼š<b>shy521.webn.cc</b></p>
            <p>åŠ å…¥ TG ç¾¤ç»„ï¼š<a href="https://t.me/ss_keyun" target="_blank">ç‚¹å‡»åŠ å…¥</a></p>
            <p>ä¸ä¼šä½¿ç”¨ï¼Ÿè¯·æŸ¥çœ‹å·¦ä¾§ã€Œä½¿ç”¨æ–‡æ¡£ã€ã€‚</p>

            <button id="noticeBtn"
                    style="margin-top:16px;width:100%;padding:10px;border:none;
                    background:#ff6faf;color:white;border-radius:10px;
                    font-weight:600;cursor:pointer;">
              æˆ‘å·²çŸ¥æ™“
            </button>
          </div>
        </div>`;
      }

      // æ˜¾ç¤ºå¼¹çª—
      function showPopup() {
        document.body.insertAdjacentHTML("beforeend", popupHTML());
        const close = () => document.getElementById("noticePopup")?.remove();
        document.getElementById("noticeClose").onclick = close;
        document.getElementById("noticeBtn").onclick = close;
      }

      // Dashboard åˆ¤æ–­ (ç™»å½•æˆåŠŸ)
      function dashboardReady() {
        const t = document.body.innerText;
        return t.includes("ä»ªè¡¨ç›˜") ||
               t.includes("Dashboard") ||
               t.includes("å¥—é¤") ||
               t.includes("é¦–é¡µ");
      }

      // å¼¹çª—æµç¨‹æ§åˆ¶
      function beginPopupProcess() {

        /** ç¬¬ä¸€å¼¹çª— */
        if (!sessionStorage.getItem("first_popup_done")) {
          showPopup();
          sessionStorage.setItem("first_popup_done", "1");
        }

        /** ç¬¬äºŒå¼¹çª—æµç¨‹ï¼šç‚¹å‡»ç›‘æ§ + éšæœºå¼¹çª— */
        if (!sessionStorage.getItem("second_popup_done")) {

          // ç­‰å¾…ç”¨æˆ·å…³é—­ç¬¬ä¸€æ¬¡å¼¹çª—
          const waitFirstClose = setInterval(() => {
            if (!document.getElementById("noticePopup")) {
              clearInterval(waitFirstClose);

              // å¼€å§‹ç›‘å¬ 60 ç§’ç‚¹å‡»
              let clicked = false;
              const clickListener = () => {
                if (!clicked) {
                  clicked = true;
                  const delay = 3000 + Math.random() * 7000; // 3~10 ç§’
                  setTimeout(() => {
                    showPopup();
                    sessionStorage.setItem("second_popup_done", "1");
                  }, delay);
                }
              };

              document.addEventListener("click", clickListener, { once: true });

              // 60 ç§’åå–æ¶ˆç›‘å¬
              setTimeout(() => {
                document.removeEventListener("click", clickListener);
              }, 60000);
            }
          }, 300);
        }
      }

      // ç­‰å¾… Dashboard æ¸²æŸ“å®Œæˆåæ‰§è¡Œå¼¹çª—é€»è¾‘
      let checkCount = 0;
      const checkLogin = setInterval(() => {
        if (dashboardReady()) {
          clearInterval(checkLogin);
          beginPopupProcess();
        }
        if (++checkCount > 80) clearInterval(checkLogin); // è¶…æ—¶ä¿æŠ¤
      }, 400);

    })();
  </script>

  <!-- ç²‰é‡‘è‰²ä¸»é¢˜ CSS -->
  <link rel="stylesheet" href="/assets/custom-theme.css">

  <!-- UMI ä¸»æ–‡ä»¶ -->
  <script type="module" crossorigin src="/assets/umi.js"></script>
</head>

<body>
  <script src="./env.js"></script>
  <div id="app"></div>
</body>
</html>
